document.addEventListener("DOMContentLoaded",(function(){var e=[].slice.call(document.querySelectorAll("img.lazy")),t=[].slice.call(document.querySelectorAll(".lazy-background")),n=[].slice.call(document.querySelectorAll("[data-bg]"));if("IntersectionObserver"in window){let o=new IntersectionObserver((function(e,t){e.forEach((function(e){if(e.isIntersecting){let t=e.target;t.src=t.dataset.src,t.srcset=t.dataset.srcset,t.classList.remove("lazy"),o.unobserve(t)}}))}));e.forEach((function(e){o.observe(e)}));let c=new IntersectionObserver((function(e,t){e.forEach((function(e){e.isIntersecting&&(e.target.classList.add("visible"),c.unobserve(e.target))}))}));t.forEach((function(e){c.observe(e)}));let a=new IntersectionObserver((function(e,t){e.forEach((function(e){if(e.isIntersecting){let t=e.target;t.style.backgroundImage="url("+t.dataset.bg+")",a.unobserve(t)}}))}));n.forEach((function(e){a.observe(e)}))}else e.forEach((function(e){e.src=e.dataset.src,e.srcset=e.dataset.srcset})),t.forEach((function(e){e.classList.add("visible")})),n.forEach((function(e){e.style.backgroundImage="url("+e.dataset.bg+")"}))})),document.addEventListener("DOMContentLoaded",(function(){firebase.initializeApp({apiKey:"AIzaSyBaSqV163g8Y7DHH07fy1IoHAFmzhk8FkA",authDomain:"vrtzgs.firebaseapp.com",databaseURL:"https://vrtzgs.firebaseio.com",projectId:"vrtzgs",storageBucket:"vrtzgs.appspot.com",messagingSenderId:"1094159227719",appId:"1:1094159227719:web:0f9b1eafab5e339af1ca62",measurementId:"G-J0J4GRRR4W"});const e=firebase.firestore();if(document.querySelector("body").classList.contains("home")){document.querySelector("#form").addEventListener("submit",(function(t){t.preventDefault();const n=document.querySelector("#first_name_1").value,o=document.querySelector("#last_name_1").value,c=document.querySelector("#first_name_2").value,a=document.querySelector("#last_name_2").value;e.collection("users").add({first_name_1:n,last_name_1:o,first_name_2:c,last_name_2:a,is_approved:!1}).then((function(e){document.querySelector("#output").classList.remove("hidden"),document.querySelector("#output").classList.add("fadeInDown"),document.querySelector("#output_link").value=`${window.location.href.split("#")[0]}sertificate.html?id=${e.id}`})).catch((function(e){console.error("Error adding document: ",e)}))})),e.collection("users").where("is_approved","==",!0).limit(9).get().then(e=>{e.forEach(e=>{data=e.data(),document.querySelector("#clients").innerHTML+=`\n\t\t\t\t\t\t\t<div class="col-md-4 client">${data.first_name_1} и ${data.first_name_2}</div>\n\t\t\t\t\t\t`})}).catch((function(e){console.log("Error getting documents: ",e)}));const t=document.querySelector("#copyBtn"),n=document.querySelector("#output_link");t.addEventListener("click",(function(){n.select(),document.execCommand("copy"),t.innerHTML='<i class="fa fa-copy"></i>Ссылка скопирована',setTimeout((function(){t.innerHTML='<i class="fa fa-copy"></i>Копировать ссылку'}),3e3)}))}if(document.querySelector("body").classList.contains("page")){const t=location.search;e.collection("users").doc(t.split("=")[1]).get().then((function(n){if(n.exists){e.collection("users").doc(t.split("=")[1]).update({is_approved:is_approved=!0}),data=n.data();const o=document.createElement("canvas"),c=o.getContext("2d"),a=new Image;o.id="mycanvas",o.width=900,o.height=1600,document.querySelector("#sertificate").appendChild(o),a.onload=function(){c.drawImage(a,0,0,o.width,o.height),c.fillStyle="#ffffff",c.font="30px Optima Cyr",c.fillText(data.first_name_1,240,650),c.fillText(data.first_name_2,540,650),c.fillText(data.last_name_1,240,740),c.fillText(data.last_name_2,540,740)},a.src="https://unrealstuffs.github.io/vrtzgs/img/@2x/sertificate.jpg";const r=document.createElement("button");r.classList.add("button"),r.innerHTML="Скачать",document.querySelector("#sertificate").appendChild(r),r.addEventListener("click",(function(){const e=document.createElement("a");e.href=mycanvas.toDataURL("image/png"),e.download="picture.png",e.style.display="none",document.body.appendChild(e),e.click(),e.parentNode.removeChild(e)}))}else console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))}document.querySelector("body").classList.contains("clients-list")&&e.collection("users").where("is_approved","==",!0).get().then(e=>{e.forEach(e=>{data=e.data(),document.querySelector("#content").innerHTML+=`\n\t\t\t\t\t\t\t<p>${data.first_name_1} и ${data.first_name_2}</p>\n\t\t\t\t\t\t`})}).catch((function(e){console.log("Error getting documents: ",e)}));const t=new Date;document.querySelector("#footer span").innerHTML=t.getFullYear()}));